# 加密貨幣資金費率套利系統

基於 Bybit API 的智能資金費率套利系統，支持 Demo 和主網交易。

## 🚀 核心功能

- **智能交易規則**：自動獲取各幣種的交易限制和精度要求
- **一鍵套利**：現貨做多 + 合約做空，賺取正資金費率
- **精確平倉**：賣出與空單相等數量的現貨，平掉空頭合約
- **持倉管理**：實時顯示現貨和合約持倉，支持部分平倉
- **風險控制**：動態調整最小投資金額，智能槓桿管理

## 📁 項目結構

```
newleg222/
├── streamlit_app.py          # 主應用界面
├── arbitrage_engine.py       # 套利引擎核心邏輯
├── bybit_client.py          # Bybit API 客戶端
├── trading_rules.py         # 智能交易規則管理
├── config.py               # 配置文件
├── available_trading_pairs.json  # 可用交易對列表
├── requirements.txt        # Python 依賴
└── README.md              # 項目說明
```

## 🛠️ 安裝和運行

1. **安裝依賴**：
```bash
pip install -r requirements.txt
```

2. **配置 API**：
在項目根目錄創建 `.env` 文件：
```
BYBIT_MAINNET_API_KEY=your_api_key
BYBIT_MAINNET_SECRET_KEY=your_secret_key
USE_DEMO=true
```

3. **啟動應用**：
```bash
streamlit run streamlit_app.py --server.port 8501
```

4. **訪問網頁**：
打開瀏覽器訪問 `http://localhost:8501`

## 💡 使用指南

### 1. 連接 API
- 選擇 Demo 或主網環境
- 輸入 API 密鑰和私鑰
- 點擊連接按鈕

### 2. 執行套利
- 在"📊 套利機會"選項卡中選擇交易對
- 系統會自動顯示該幣種的交易規則和最小投資金額
- 設置總投資金額和槓桿倍數
- 點擊"🚀 一鍵套利"執行交易

### 3. 管理持倉
- 在"💼 持倉管理"選項卡中查看所有持倉
- 可以對單個持倉進行平倉操作
- 支持部分平倉（只平掉套利部分，保留剩餘現貨）

### 4. 交易規則
- 在"📋 交易對管理"選項卡中瀏覽所有可用交易對
- 使用搜尋功能快速找到目標幣種
- 查看各幣種的詳細交易規則

## ⚠️ 重要說明

- **Demo 環境**：建議先在 Demo 環境中測試所有功能
- **最小投資**：Demo API 有較高的最小交易金額要求
- **風險管理**：請根據自己的風險承受能力設置投資金額
- **精度要求**：系統會自動處理各幣種的數量精度要求

## 🔧 技術特點

- **智能精度管理**：自動獲取並應用各幣種的數量精度要求
- **動態規則更新**：實時獲取最新的交易規則和限制
- **錯誤處理**：完善的錯誤提示和異常處理機制
- **持倉同步**：自動同步 API 持倉與本地記錄

## 📊 支持的交易對

系統支持 300+ 個 USDT 交易對，包括：
- 主流幣種：BTC, ETH, SOL, ADA, DOT, LINK 等
- 新興幣種：AVAX, ATOM, NEAR, MATIC 等
- 完整列表請查看 `available_trading_pairs.json`

## 🎯 套利原理

1. **開倉**：買入現貨 + 賣出等量合約（做空）
2. **持倉**：賺取正資金費率
3. **平倉**：賣出與空單相等數量的現貨 + 買入合約平空

## ⚠️ 風險提示

- 加密貨幣價格波動劇烈，可能造成重大損失
- 資金費率可能轉為負值，導致需要支付費用
- 請在 Demo 環境中充分測試後再使用真實資金

---

**免責聲明**：本系統僅供學習和研究使用，實際交易請謹慎評估風險。