# 資金費率分析報告

## 功能概述

對衝套利系統已經完全整合了真實的資金費率數據，從Bybit交易所的模擬交易區實時獲取。

## 資金費率獲取機制

### API 端點
- **端點**: `/v5/market/funding/history`
- **參數**: `category=linear`, `symbol=PERP格式`, `limit=1`
- **更新頻率**: 實時獲取最新資金費率

### 交易對轉換
- `BTCUSDT` → `BTCPERP`
- `ETHUSDT` → `ETHPERP`
- `SOLUSDT` → `SOLPERP`
- 等等...

## 當前資金費率狀況 (實時數據)

| 交易對 | 資金費率 | 百分比 | 方向 | 建議 |
|--------|----------|--------|------|------|
| BTCUSDT | -0.000011 | -0.0011% | 負 | 中性 |
| ETHUSDT | 0.000034 | 0.0034% | 正 | 可考慮 |
| SOLUSDT | 0.000087 | 0.0087% | 正 | 推薦 |
| ADAUSDT | 0.000100 | 0.0100% | 正 | 推薦 |
| DOTUSDT | 0.000071 | 0.0071% | 正 | 推薦 |
| LINKUSDT | 0.000100 | 0.0100% | 正 | 推薦 |
| UNIUSDT | 0.000050 | 0.0050% | 正 | 可考慮 |
| LTCUSDT | 0.000050 | 0.0050% | 正 | 可考慮 |
| BCHUSDT | 0.000050 | 0.0050% | 正 | 可考慮 |
| XRPUSDT | 0.000100 | 0.0100% | 正 | 推薦 |
| AVAXUSDT | 0.000100 | 0.0100% | 正 | 推薦 |
| ATOMUSDT | 0.000100 | 0.0100% | 正 | 推薦 |
| NEARUSDT | 0.000100 | 0.0100% | 正 | 推薦 |

## 統計分析

- **正費率**: 12 個交易對
- **負費率**: 1 個交易對 (BTCUSDT)
- **零費率**: 0 個交易對

## 資金費率收益計算

### 計算公式
```
資金費率收益 = 合約價值 × 資金費率 × 收取週期數
```

### 收取週期
- **頻率**: 每8小時收取一次
- **時間**: 00:00, 08:00, 16:00 (UTC)
- **持倉時間**: 至少8小時才能收取

### 示例計算 (SOLUSDT, 16小時持倉)
- 合約價值: 2,348 USDT
- 資金費率: 0.000087 (0.0087%)
- 收取週期: 2 次
- 資金費率收益: 2,348 × 0.000087 × 2 = 0.41 USDT

## 對衝套利盈虧計算

### 完整公式
```
總淨利 = 現貨盈虧 + 合約盈虧 + 資金費率收益 - 手續費
```

### 各組件說明
1. **現貨盈虧**: (賣出價格 - 買入價格) × 數量
2. **合約盈虧**: (做空價格 - 平倉價格) × 數量
3. **資金費率收益**: 合約價值 × 資金費率 × 收取週期數
4. **手續費**: 現貨手續費 + 合約手續費

## 策略建議

### 推薦交易對
- **強烈推薦** (資金費率 > 0.01%): 目前無
- **推薦** (資金費率 > 0.005%): SOLUSDT, ADAUSDT, DOTUSDT, LINKUSDT, XRPUSDT, AVAXUSDT, ATOMUSDT, NEARUSDT
- **可考慮** (資金費率 > 0): ETHUSDT, UNIUSDT, LTCUSDT, BCHUSDT

### 操作建議
1. **選擇時機**: 資金費率 > 0.005% 時開倉
2. **持倉時間**: 至少16小時以收取多次資金費率
3. **監控變化**: 實時監控資金費率變化
4. **降低成本**: 考慮使用限價單降低手續費

### 風險提示
- 資金費率會動態變化
- 短期持倉可能無法覆蓋手續費成本
- 需要持續監控市場狀況

## 技術實現

### 核心方法
- `get_funding_rate(symbol)`: 獲取指定交易對的資金費率
- `calculate_funding_income(position, close_quantity)`: 計算資金費率收益

### 數據來源
- **交易所**: Bybit 模擬交易區
- **更新頻率**: 實時
- **數據格式**: JSON API 響應

## 結論

系統已完全整合真實的資金費率數據，能夠準確計算對衝套利的完整盈虧，包括價格差異、手續費和資金費率收益。建議選擇資金費率較高的交易對進行對衝套利操作。
